$ulist.Count
$i=0
$d=0
foreach ($i in $ulist)
{
    $d=(Get-Aduser -Identity $i -properties PasswordNeverExpires ).passwordneverexpires
    
    if ($d -eq $false)
    {
       Add-Content -Path "C:\EDR\pwd_exp_users_10May.txt" -Value "$i  done"
    }
    else
    {
         Add-Content -Path "C:\EDR\pwd_never_exp_unchecked_users_10May.txt" -Value "$i not ok"
         Set-Aduser -Identity $i -passwordneverexpires $false
    }

    foreach ($i in $ulist)
{
    
    $a=Get-ADUser -Identity $i -Properties * | Select-Object pwdlastset
    if ($a.pwdlastset -eq 0)
    {
       Add-Content -Path "C:\edr\users_already_forced_to_chg_pwd.txt" -Value "$i  done"
    }
    else
    {
         Add-Content -Path "C:\edr\users_forced_to_change_password.txt" -Value "$i not ok"
         Set-Aduser -Identity $i -ChangePasswordAtLogon $true
    }
}